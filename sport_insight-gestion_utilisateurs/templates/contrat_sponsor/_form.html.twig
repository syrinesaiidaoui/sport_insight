{{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}
    
    {# Afficher les erreurs globales du formulaire #}
    {% if form.vars.errors|length > 0 %}
        <div class="alert alert-danger" role="alert">
            <h5>Erreur de validation</h5>
            {% for error in form.vars.errors %}
                <p>{{ error.message }}</p>
            {% endfor %}
        </div>
    {% endif %}
    
    {# Afficher chaque champ avec ses erreurs #}
    <div class="form-fields">
        {% for child in form %}
            {% if child.vars.name != '_token' %}
                <div class="form-group {% if child.vars.errors|length > 0 %}has-error{% endif %}">
                    {{ form_label(child) }}
                    {{ form_widget(child) }}
                    {% if child.vars.errors|length > 0 %}
                        <div class="invalid-feedback" style="display: block;">
                            {% for error in child.vars.errors %}
                                <div class="error-message">
                                    <i class="lucide-alert-circle" style="font-size: 14px; margin-right: 5px;"></i>
                                    {{ error.message }}
                                </div>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>
            {% endif %}
        {% endfor %}
    </div>
    
    <div class="form-actions">
        <button type="submit" class="btn btn-save">{{ button_label|default('Enregistrer') }}</button>
    </div>
{{ form_end(form) }}

<style>
    .alert-danger {
        background-color: #fee2e2;
        border: 1px solid #fecaca;
        color: #b91c1c;
        padding: 12px 16px;
        border-radius: 6px;
        margin-bottom: 20px;
    }
    
    .alert-danger h5 {
        margin: 0 0 8px 0;
        font-weight: 600;
    }
    
    .alert-danger p {
        margin: 5px 0;
        font-size: 14px;
    }
    
    .form-fields {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }
    
    .form-group {
        display: flex;
        flex-direction: column;
        margin-bottom: 0;
    }
    
    .form-group.has-error input,
    .form-group.has-error select,
    .form-group.has-error textarea {
        border-color: #dc2626 !important;
        background-color: #fef2f2;
    }
    
    .form-group label {
        margin-bottom: 8px;
        font-weight: 500;
        color: var(--text-dark);
        font-size: 14px;
    }
    
    .form-group.has-error label {
        color: #b91c1c;
    }
    
    .form-control {
        padding: 8px 12px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 14px;
        font-family: inherit;
        transition: border-color 0.3s;
    }
    
    .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }
    
    input[type="text"],
    input[type="email"],
    input[type="number"],
    input[type="tel"],
    input[type="date"],
    input[type="datetime-local"],
    select,
    textarea {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        font-size: 14px;
        font-family: inherit;
        transition: border-color 0.3s;
        margin-bottom: 0px;
    }
    
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="number"]:focus,
    input[type="tel"]:focus,
    input[type="date"]:focus,
    input[type="datetime-local"]:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }
    
    .invalid-feedback {
        background-color: #fee2e2;
        border: 1px solid #fecaca;
        color: #b91c1c;
        padding: 8px 12px;
        border-radius: 4px;
        font-size: 13px;
        margin-top: 6px;
    }
    
    .error-message {
        display: flex;
        align-items: center;
        margin: 3px 0;
    }
    
    .form-actions {
        display: flex;
        gap: 12px;
        margin-top: 25px;
    }
    
    .btn-save {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 20px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: 500;
        transition: background 0.3s;
    }
    
    .btn-save:hover {
        background: var(--primary-hover);
        color: white;
    }
</style>


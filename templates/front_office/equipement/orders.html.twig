{% extends 'front_office/base.html.twig' %}

{% block title %}Mes commandes - Sport Insight{% endblock %}

{% block body %}
<div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-end;flex-wrap:wrap;margin-bottom:14px;">
    <div>
        <h1 class="section-title" style="margin-bottom:4px;">Mes commandes</h1>
        <p style="margin:0;color:#64748b;">Suivez vos expeditions, consultez la politique de retour et recommandez vos essentiels football.</p>
    </div>
    <a href="{{ path('front_equipement_index') }}" class="btn btn-secondary">Continuer vos achats</a>
</div>

<div style="display:grid;gap:12px;">
    {% for order in orders %}
        {% set displayProduct = order.product %}
        {% if (not displayProduct) and order.items|length > 0 %}
            {% set displayProduct = order.items|first.product %}
        {% endif %}
        {% set displayQty = order.quantity ?: (order.items|length > 0 ? order.items|first.quantity : 0) %}
        {% set displayTotal = order.totalAmount ?: order.computedTotal %}
        <article class="front-card" style="display:grid;grid-template-columns:1fr auto;gap:12px;align-items:center;">
            <div>
                <p style="margin:0 0 4px;color:#64748b;font-size:12px;text-transform:uppercase;letter-spacing:.5px;font-weight:800;">Commande #{{ order.id }} | {{ order.orderDate|date('Y-m-d H:i') }}</p>
                <h2 style="font-size:30px;margin:0 0 6px;">{{ displayProduct ? displayProduct.name : 'Commande multi-produits' }}</h2>
                <p style="margin:0;color:#64748b;font-size:14px;">{{ displayProduct ? (displayProduct.brand ?: 'Sport Insight') : 'Sport Insight' }} | {{ displayProduct ? (displayProduct.category ?: 'Equipement football') : 'Equipement football' }}</p>
                <p style="margin:7px 0 0;font-size:13px;color:#475569;">Qte : {{ displayQty }} | Total : {{ displayTotal|number_format(2, '.', ',') }} USD</p>
                <p style="margin:7px 0 0;font-size:12px;color:#64748b;">Paiement : {{ order.paymentMethod == 'online' ? 'En ligne' : 'A la livraison' }} | Statut paiement : {{ order.paymentStatus ?: 'pending' }}</p>
            </div>
            <div style="text-align:right;">
                {% set status = order.status|lower %}
                <span class="badge-soft" style="display:inline-block;margin-bottom:8px;">{{ order.status|upper }}</span>
                <div style="font-size:12px;color:#64748b;">ID de suivi : SI-{{ order.id }}-{{ order.orderDate|date('ymd') }}</div>
                <div style="font-size:12px;color:#64748b;">Retour possible jusqu au {{ order.orderDate|date_modify('+30 days')|date('Y-m-d') }}</div>
            </div>
        </article>
    {% else %}
        <div class="front-card" style="text-align:center;">
            <h2 style="font-size:34px;margin:0 0 8px;">Aucune commande pour le moment</h2>
            <p style="margin:0 0 12px;color:#64748b;">Commencez vos achats pour construire votre historique et vos tailles enregistrees.</p>
            <a href="{{ path('front_equipement_index') }}" class="btn btn-primary">Voir les produits</a>
        </div>
    {% endfor %}
</div>
{% endblock %}
